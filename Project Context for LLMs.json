CONTEXT_START
{
  "project": {
    "name": "Vulnerability Management & Patch Compliance Platform",
    "module": "Enterprise Project",
    "course": "BSc Cyber Security",
    "year": 2,
    "semester": 2,
    "goal": "Design and implement an enterprise-style vulnerability management platform that integrates asset management, vulnerability scanning via Greenbone/OpenVAS, custom risk scoring, remediation tracking, automation, audit logging, and reporting, following secure coding and enterprise best practices."
  },

  "deployment": {
    "os": "Ubuntu Server 22.04",
    "reverseProxy": "Nginx",
    "backend": {
      "language": "Python",
      "framework": "Flask",
      "wsgiServer": "Gunicorn"
    },
    "frontend": {
      "languages": ["HTML", "CSS"],
      "templating": "Jinja2",
      "javascript": "Minimal or none"
    },
    "database": "MySQL",
    "https": {
      "enabled": true,
      "termination": "Nginx",
      "certificate": "Self-signed (development)",
      "browserWarning": "Expected (untrusted CA, still encrypted)"
    },
    "processManagement": "systemd",
    "firewall": "UFW"
  },

  "scanningSubsystem": {
    "language": "Python",
    "architecture": "Dedicated worker/service",
    "tools": ["Greenbone/OpenVAS", "Nmap"],
    "interfaces": {
      "database": "Shared MySQL database",
      "coordination": "Scan/job records written by Flask app"
    },
    "features": {
      "greenbone": [
        "Authenticate to Greenbone/OpenVAS API",
        "Create scan targets",
        "Create scan tasks",
        "Start scans",
        "Poll scan status",
        "Retrieve raw vulnerability results"
      ],
      "nmap": [
        "Discover live IPs when scan scope is ALL",
        "Validate discovered hosts",
        "Optional reconciliation with asset database"
      ],
      "dataProcessing": [
        "Normalise vulnerability data",
        "Extract vulnerability identifier (CVE or NVT OID)",
        "Extract CVSS base score",
        "Extract port and protocol",
        "Persist processed results to database"
      ]
    }
  },

  "security": {
    "authentication": {
      "method": "Username and password",
      "passwordStorage": "Hashed passwords (bcrypt or Werkzeug)",
      "sessions": {
        "framework": "Flask-Login",
        "secureCookies": true,
        "regenerateOnLogin": true,
        "invalidateOnLogout": true
      },
      "rbac": {
        "roles": ["ADMIN", "VIEWER"],
        "enforcedServerSide": true
      }
    },
    "csrfProtection": {
      "enabled": true,
      "framework": "Flask-WTF"
    },
    "secureCoding": [
      "Prepared SQL statements / ORM",
      "Input validation",
      "Output escaping (Jinja2)",
      "No sensitive data in logs",
      "Least-privilege database user"
    ],
    "httpSecurityHeaders": "Flask-Talisman"
  },

  "auditLogging": {
    "description": "Explicit inserts into audit_log table for all security-relevant and system events",
    "loggedEvents": [
      "login_success",
      "login_failure",
      "logout",
      "asset_created",
      "asset_updated",
      "asset_retired",
      "scan_started",
      "scan_failed",
      "scan_completed",
      "ticket_created",
      "ticket_updated",
      "ticket_closed_manual",
      "ticket_closed_auto_rescan",
      "report_generated",
      "scheduled_scan_started"
    ],
    "notes": [
      "Audit events may be user-driven or system-generated",
      "System-generated events have null user_id"
    ]
  },

  "dataModel": {
    "tables": {
      "users": {
        "fields": [
          "id",
          "username",
          "password_hash",
          "role",
          "created_at"
        ]
      },
      "assets": {
        "fields": [
          "id",
          "name",
          "ip_address",
          "asset_type",
          "exposure",
          "criticality",
          "created_at",
          "updated_at",
          "retired_at"
        ],
        "constraints": [
          "ip_address UNIQUE"
        ]
      },
      "scans": {
        "fields": [
          "id",
          "started_by_user_id",
          "scope_type",
          "status",
          "openvas_task_id",
          "started_at",
          "finished_at",
          "error_message"
        ]
      },
      "scan_targets": {
        "type": "join_table",
        "fields": [
          "scan_id",
          "asset_id"
        ],
        "purpose": "Many-to-many relationship between scans and assets"
      },
      "findings": {
        "fields": [
          "id",
          "scan_id",
          "asset_id",
          "vuln_key",
          "title",
          "raw_cvss",
          "port",
          "protocol",
          "evidence",
          "detected_at"
        ]
      },
      "tickets": {
        "fields": [
          "id",
          "asset_id",
          "vuln_key",
          "risk_score",
          "status",
          "created_at",
          "updated_at",
          "closed_at",
          "closure_reason",
          "last_confirmed_scan_id"
        ],
        "constraints": [
          "Unique open ticket per (asset_id + vuln_key)"
        ]
      },
      "patchactions": {
        "fields": [
          "id",
          "ticket_id",
          "action_type",
          "notes",
          "performed_at",
          "performed_by_user_id"
        ]
      },
      "audit_log": {
        "fields": [
          "id",
          "user_id",
          "event_type",
          "event_data",
          "created_at"
        ]
      }
    }
  },

  "enumerations": {
    "Role": ["ADMIN", "VIEWER"],
    "Exposure": ["PUBLIC", "PRIVATE"],
    "AssetType": [
      "WEB_SERVER",
      "FILE_SERVER",
      "DATABASE_SERVER",
      "APPLICATION_SERVER",
      "WORKSTATION",
      "NETWORK_DEVICE",
      "OTHER"
    ],
    "Criticality": [
      "LOW",
      "MEDIUM",
      "HIGH",
      "MISSION_CRITICAL"
    ],
    "ScanScope": ["ALL", "SINGLE"],
    "ScanStatus": [
      "QUEUED",
      "RUNNING",
      "COMPLETED",
      "FAILED"
    ],
    "TicketStatus": [
      "OPEN",
      "IN_PROGRESS",
      "CLOSED",
      "FALSE_POSITIVE",
      "ACCEPTED_RISK"
    ],
    "ActionType": [
      "PATCH",
      "CONFIG_CHANGE",
      "MITIGATION",
      "AUTO_VERIFIED"
    ]
  },

  "relationships": {
    "oneToMany": [
      "User -> Scans",
      "User -> PatchActions",
      "User -> AuditLogEvents",
      "Asset -> Tickets",
      "Ticket -> PatchActions",
      "Asset -> Findings",
      "Scan -> Findings"
    ],
    "manyToMany": [
      "Scan <-> Asset (via ScanTarget)"
    ],
    "notes": [
      "PatchAction.performedByUserId nullable for automated actions",
      "AuditLogEvent.userId nullable for system events",
      "Ticket-Finding association is logical via assetId + vulnKey, not strict foreign key"
    ]
  },

  "riskScoring": {
    "inputs": [
      "CVSS base score",
      "Asset exposure",
      "Asset criticality"
    ],
    "exampleModel": {
      "exposureMultiplier": {
        "PRIVATE": 1.0,
        "PUBLIC": 1.3
      },
      "criticalityMultiplier": {
        "LOW": 0.8,
        "MEDIUM": 1.0,
        "HIGH": 1.2,
        "MISSION_CRITICAL": 1.4
      },
      "formula": "min(10, cvss * exposureMultiplier * criticalityMultiplier)"
    }
  },

  "sequenceDiagrams": [
    "Login (success/failure with audit and session handling)",
    "Add Asset (validation, persistence, audit logging)",
    "Initiate Scan (single/all, scan job creation, audit)",
    "Process Scan Results -> Findings -> Risk Score -> Tickets",
    "Manual Remediation (PatchAction creation, ticket update, audit)",
    "Automatic Remediation after Rescan (worker loop with alt conditions)"
  ],

  "automation": {
    "automaticTicketClosure": {
      "trigger": "Scan completion",
      "logic": [
        "Retrieve open tickets",
        "Retrieve latest scan per asset",
        "If vuln_key not present in latest findings",
        "Insert AUTO_VERIFIED PatchAction",
        "Close ticket",
        "Insert audit event"
      ]
    },
    "scheduledScanning": {
      "method": "Cron or systemd timer",
      "status": "Optional / nice-to-have"
    }
  },

  "scrum": {
    "tooling": "Trello",
    "approach": {
      "cards": "Features / user stories",
      "checklists": [
        "Front End",
        "Back End",
        "Database",
        "Python Worker",
        "Security",
        "Testing",
        "Documentation"
      ],
      "principle": "Vertical slices (end-to-end feature delivery)"
    }
  },

  "productBacklog": {
    "includes": [
      "Environment & infrastructure setup",
      "Authentication & RBAC",
      "Asset management",
      "Scan initiation",
      "Python Greenbone/Nmap worker",
      "Scan status tracking",
      "Result processing",
      "Risk scoring",
      "Ticket management",
      "Manual remediation",
      "Automatic remediation",
      "Reporting (optional)",
      "Scheduled scans (optional)",
      "Security hardening",
      "Testing & validation",
      "Documentation & diagrams",
      "Final review & submission"
    ]
  },

  "documentationDeliverables": [
    "Requirements (user stories + MoSCoW)",
    "Wireframes",
    "Use case diagrams",
    "Sequence diagrams",
    "Class diagram",
    "ERD",
    "Ethical and legal considerations",
    "Testing evidence",
    "Deployment guide",
    "Scrum reflection"
  ],

  "deliveryConstraints": {
    "durationWeeks": 12,
    "strategy": [
      "Prioritise must-have features first",
      "De-scope polish if required",
      "Document future work explicitly"
    ]
  }
}
CONTEXT_END
